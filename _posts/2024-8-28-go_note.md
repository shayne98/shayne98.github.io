---
layout: post
title: "Go语言学习笔记"
date:   2024-8-28
tags: [Go]
comments: true
author: Shayne
toc: true
---
这篇文章中，我将整理我学习Go语言过程中的笔记

<!-- more -->

## string

### Go语言默认字符编码方式

首先需要了解字符串内部是怎么编解码的，每个字符都对应一个独一无二的数字编号，这个映射关系叫做字符集，计算机中数据存储方式使用二进制，所以对字符串编号编码和解码的关键在于字符边界的确定方法，比较直观的方式是定长编码（即每个字符使用固定长度的二进制位—），但是这种方式比较浪费内存，Go语言默认的编码方式是utf-8，这是一种通用的变长编码方法，具体而言

| 字符编号范围 | 编码模板                                  | 例子                              | 备注                                                                                                          |
| ------------ | ----------------------------------------- | --------------------------------- | ------------------------------------------------------------------------------------------------------------- |
| [0,127]      | 0*xxxxxxx*                              | 字符 'b' 编号是98，对应于01100010 | 使用一个字节来表示，高位0占位，剩下七位二进制位用于表示编号                                                   |
| [128,2047]   | 110*xxxxx *10*xxxxxx*                |                                   | 使用两个字节来表示，高位字节，高位固定110；<br />低位字节，高位固定10，剩余的二进制位组合起来就是该字符的编号 |
| [2048,65535] | 1110*xxxx* 10*xxxxxxx* 10*xxxxxx* |                                   | 使用三个字节来表示，组合方式和双字节类似，不作赘述                                                            |

例如对于’字‘在UTF-8二进制编码为1110**0101** 10**101101** 10**11111** 我们对其进行解码，将加粗的二进制组合010110110111111，编号是2782

### Go语言中string存储结构

Go语言中字符串变量由两部分组成：

| ptr | len |
| --- | --- |

1. ptr：字符串内存起始地址
2. len：字符串所占字节数量

![2025-1-4-go_note-2025-01-04-02-12-41](https://secret-land.oss-cn-hangzhou.aliyuncs.com/blog/2025-1-4-go_note-2025-01-04-02-12-41.png)

需要注意的是，Go中的字符串分配的是只读内存，且不同的字符串变量底层可以共用相同的字符串内存空间，所以不能通过 `s[1]='o'`这样来更改字符串中的字符，若要改变s字符串，可以使其重新指向一个新的字符串或者转成slice，会拷贝新的内存空间，例如

```go
s:="hello"
ss:=([]byte)s
ss[1]='o'
```
